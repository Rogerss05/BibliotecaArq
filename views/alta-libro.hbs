<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Nuevo Libro</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-slate-900 text-white font-sans flex items-center justify-center min-h-screen py-10">

    <div class="bg-slate-800 p-8 rounded-2xl shadow-2xl w-full max-w-lg border border-slate-700">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold text-cyan-400">Nuevo Libro</h2>
            <a href="/libros/admin" class="text-slate-400 hover:text-white text-sm">Cancelar</a>
        </div>

        <form action="/libros/guardar" method="post" class="space-y-4">

            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Título de la Obra</label>
                <input type="text" name="titulo" required
                    class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:border-cyan-500 transition">
            </div>

            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Género</label>
                <select name="genero"
                    class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:border-cyan-500 transition">
                    <option>Matemáticas</option>
                    <option>Literatura</option>
                    <option>Ciencias</option>
                    <option>Historia</option>
                    <option>Programación</option>
                </select>
            </div>

            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Portada (Imagen)</label>
                <input type="file" accept="image/*" id="inputPortada"
                    class="block w-full text-sm text-slate-400 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-cyan-900 file:text-cyan-400 hover:file:bg-cyan-800 cursor-pointer bg-slate-700 rounded-lg border border-slate-600">

                <input type="hidden" name="portada" id="base64Portada">
            </div>

            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Archivo PDF</label>
                <input type="file" accept="application/pdf" id="inputPdf"
                    class="block w-full text-sm text-slate-400 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-red-900 file:text-red-400 hover:file:bg-red-800 cursor-pointer bg-slate-700 rounded-lg border border-slate-600">

                <input type="hidden" name="pdf" id="base64Pdf">
            </div>

            <button type="submit"
                class="w-full bg-cyan-600 hover:bg-cyan-500 text-white font-bold py-3 rounded-lg shadow-lg transition transform hover:scale-105 mt-4">
                Guardar Libro
            </button>
        </form>
    </div>

    <script>
        // Función reutilizable para convertir archivo a Base64
        const convertBase64 = (file) => {
            return new Promise((resolve, reject) => {
                const fileReader = new FileReader();
                fileReader.readAsDataURL(file);

                fileReader.onload = () => {
                    resolve(fileReader.result);
                };

                fileReader.onerror = (error) => {
                    reject(error);
                };
            });
        };

        // Escuchar cambios en la PORTADA
        document.getElementById('inputPortada').addEventListener('change', async (event) => {
            const file = event.target.files[0];
            if (file) {
                const base64 = await convertBase64(file);
                document.getElementById('base64Portada').value = base64; // Guardar en el oculto
                console.log("Portada convertida!");
            }
        });

        // Escuchar cambios en el PDF
        document.getElementById('inputPdf').addEventListener('change', async (event) => {
            const file = event.target.files[0];
            if (file) {
                const base64 = await convertBase64(file);
                document.getElementById('base64Pdf').value = base64; // Guardar en el oculto
                console.log("PDF convertido!");
            }
        });
    </script>
</body>

</html>