<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Editar Libro</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-slate-900 text-white font-sans flex items-center justify-center min-h-screen py-10">

    <div class="bg-slate-800 p-8 rounded-2xl shadow-2xl w-full max-w-lg border border-slate-700">
        <h2 class="text-2xl font-bold text-cyan-400 mb-6">Editar Libro #{{libro.id}}</h2>

        <form action="/libros/actualizar/{{libro.id}}" method="post" class="space-y-4">

            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Título</label>
                <input type="text" name="titulo" value="{{libro.titulo}}" required
                    class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:border-cyan-500 transition">
            </div>

            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Género (Actual: {{libro.genero}})</label>
                <select name="genero"
                    class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:border-cyan-500 transition">
                    <option value="{{libro.genero}}" selected>Dejar igual ({{libro.genero}})</option>
                    <option>Matemáticas</option>
                    <option>Literatura</option>
                    <option>Ciencias</option>
                    <option>Historia</option>
                    <option>Programación</option>
                </select>
            </div>

            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Portada</label>
                <input type="file" accept="image/*" id="inputPortada"
                    class="block w-full text-sm text-slate-400 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-cyan-900 file:text-cyan-400 hover:file:bg-cyan-800 cursor-pointer bg-slate-700 rounded-lg border border-slate-600">
                <input type="hidden" name="portada" id="base64Portada" value="{{libro.portada}}">
                <p class="text-xs text-slate-500 mt-1">Si no seleccionas nada, se mantiene la imagen anterior.</p>
            </div>

            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Archivo PDF</label>
                <input type="file" accept="application/pdf" id="inputPdf"
                    class="block w-full text-sm text-slate-400 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-red-900 file:text-red-400 hover:file:bg-red-800 cursor-pointer bg-slate-700 rounded-lg border border-slate-600">
                <input type="hidden" name="pdf" id="base64Pdf" value="{{libro.pdf}}">
                <p class="text-xs text-slate-500 mt-1">Si no seleccionas nada, se mantiene el PDF anterior.</p>
            </div>

            <div class="flex space-x-4 pt-4">
                <a href="/libros/admin-lista"
                    class="flex-1 py-2 text-center text-slate-400 hover:text-white border border-slate-600 rounded-lg transition">Cancelar</a>
                <button type="submit"
                    class="flex-1 bg-cyan-600 hover:bg-cyan-500 text-white font-bold py-2 rounded-lg shadow-lg transition">
                    Guardar Cambios
                </button>
            </div>
        </form>
    </div>

    <script>
        const convertBase64 = (file) => {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
            });
        };

        document.getElementById('inputPortada').addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (file) document.getElementById('base64Portada').value = await convertBase64(file);
        });

        document.getElementById('inputPdf').addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (file) document.getElementById('base64Pdf').value = await convertBase64(file);
        });
    </script>
</body>

</html>